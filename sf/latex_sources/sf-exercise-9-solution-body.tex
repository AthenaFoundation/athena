% ------------------------------------------------------------------------
% file `sf-exercise-9-solution-body.tex'
%
%     solution of type `exercise' with id `9'
%
% generated by the `solution' environment of the
%   `xsim' package v0.16a (2020/01/16)
% from source `sf' on 2024/06/09 on line 867
% ------------------------------------------------------------------------
\begin{tcAthena}
datatype Bin := Z | (Twice Bin) | (Twice+1 Bin)
assert (datatype-axioms "Bin")

define [n m] := [?n:Bin ?m:Bin]

declare inc: [Bin] -> Bin

assert* inc-def := [(inc Z = Twice+1 Z)
                    (inc Twice n = Twice+1 n)
                    (inc Twice+1 n = Twice inc n)]

declare bin->nat: [Bin] -> Nat.Nat

assert* bin->nat-def := [(bin->nat Z = Nat.Zero)
                         (bin->nat Twice n = 2 Nat.* bin->nat n)
                         (bin->nat Twice+1 n = 1 Nat.+ 2 Nat.* bin->nat n)]

define one := (Twice+1 Z)

# This should give 5. Read it from right to
# left: inc(twice(twice(one))) = 1 + 2 * (2 * 1)

(eval bin->nat inc Twice Twice one)

declare nat->bin: [Nat.Nat] -> Bin [[int->nat]]

assert* nat->bin-def := [(nat->bin Nat.Zero = Z)
                         (nat->bin Nat.Succ x = inc nat->bin x)]

(eval nat->bin Nat.Succ Nat.Succ Nat.Succ Nat.Succ Nat.Zero)
\end{tcAthena}
